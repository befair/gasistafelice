<script>
$("#checkAll").click(function(){
    $('input:checkbox').not(this).prop('checked', this.checked);
});
</script>

<div class="tab-pane" id="paniere">
    
    <div class="ord-ord-title">Il tuo paniere</div>
        <div class="searchbar">
          <span class="font-searchbar"><span class="glyphicon glyphicon-search"></span></span>
          <input type="text" class="searchbar-text" id="search-bar-open" placeholder="Cerca tra i prodotti" ng-model="searchQueryOpen"/>       
      </div> 

    <!--
    <form ng-controller="FrmPaniereController"> 
        <button ng-click="basket.addtoCart();" class="def-btn" type="submit">
            <span class="glyphicon glyphicon-shopping-cart"></span>Aggiorna paniere
        </button>
    -->

    <table class="table gas">   
    <thead>  
        <tr>  
            <!-- <th>ID</th> -->
            <th scope="col" ng-click="orderByField='order_id'; basket.reverseSort = !basket.reverseSort">Ordine
              <span ng-show="orderByField == 'order_id'" class="listorder">
                <span ng-show="!basket.reverseSort"><i class="fa fa-sort-desc"></i></span>
                <span ng-show="basket.reverseSort"><i class="fa fa-sort-asc"></i></span>
              </span>
            </th>  
            <!-- <th>Stato</th>  -->
            <th scope="col" ng-click="orderByField='supplier'; basket.reverseSort = !basket.reverseSort">Fornitore
              <span ng-show="orderByField == 'supplier'" class="listorder">
                <span ng-show="!basket.reverseSort"><i class="fa fa-sort-desc"></i></span>
                <span ng-show="basket.reverseSort"><i class="fa fa-sort-asc"></i></span>
            </span>
            </th>  
            <th scope="col" ng-click="orderByField='name'; basket.reverseSort = !basket.reverseSort">Prodotto
              <span ng-show="orderByField == 'name'" class="listorder">
                <span ng-show="!basket.reverseSort"><i class="fa fa-sort-desc"></i></span>
                <span ng-show="basket.reverseSort"><i class="fa fa-sort-asc"></i></span>
            </span>
            </th>  
            <th>Prezzo (€)</th>  
            <th>Quantit&agrave;</th>  
            <th>Totale</th>  
            <th style="text-align:center">Cancella</th>   
        </tr>  
    </thead>
    <tbody ng-hide="basket.dataLoaded">
        <tr><td colspan="8">
            <p style="text-align:center" ng-hide="basket.dataLoaded">
            Aspetta che carico il paniere... <i class="fa fa-spinner fa-spin"></i>
            </p>
        </td></tr>
    </tbody>

    <tbody ng-show="basket.pm.basket_empty">
        <tr><td colspan="8">
            <p style="text-align:center">Il paniere è vuoto </p>
        </td></tr>
    </tbody>

    <tbody ng-show="basket.dataLoaded">  
    <tr ng-repeat="item in basket.open_ordered_products | filter: searchQueryOpen" class="{{item.order_state}}">
    
        <!-- <td data-title="image" class="tdprod">{{item.id}}</td> -->
        <td data-title="image" class="tdprod">{{item.order_shortname}}</td>  
        <td data-title="image" class="tdprod">{{item.supplier}}</td>  
        <td data-title="image" class="tdprod">{{item.name}}</td>  
        <td data-title="image" class="tdprice">{{item.price|currency:"€"}}</td> 
        <td data-title="add_cart" class="tdprod" style="width:10%;" ng-show="item.can_update">
            <input type="hidden" id="form-{{$index}}-id" name="form-{{$index}}-id"/>
            <input type="hidden" id="form-{{$index}}-gsop_id" name="form-{{$index}}-gsop_id" value="{{item.id}}"/>
            <input type="hidden" id="form-{{$index}}-ordered_price" name="form-{{$index}}-ordered_price"  value="{{item.price}}"/>
            <input type="hidden"  name="form-{{$index}}-ordered_amount" id="form-{{$index}}-ordered_amount" value="{{item.quantity}}"/>
            <input type="hidden" name="form-{{$index}}-gm_id" id="form-{{$index}}-gm_id" value="{{gm.id}}"/>
            <div class="input-group">
                <span class="opcart_left menu_links" ng-click="basket.pm.decrement(item);">
                    <span class="glyphicon glyphicon-minus"></span>
                </span>
            <input type="text" class="form-control" ng-blur="basket.pm.change(item);" ng-model="item.quantity" name="form-{{$index}}-ordered_amount" id="form-{{$index}}-ordered_amount"/>
                <span class="opcart_right menu_links" ng-click="basket.pm.increment(item);">
                    <span class="glyphicon glyphicon-plus"></span>
                </span>
            </div> 
        </td> 
        <td data-title="image" class="tdprod" ng-show="!item.can_update">{{item.quantity}}</td> 
        <td class="tdprice"> {{item.quantity * item.price|currency:"€"}}</td>
        <td class="tdprice">
            <fieldset ng-show="item.can_update">
                <input name="checkbox_{{$index}}" id="checkbox_{{$index}}"
                    ng-click="basket.toggleSelection($index)"
                    type="checkbox">
                       
            </fieldset>
        </td>
    </tr>
    </tbody>
    </table>

    <table class="table total">
        <tr>
            <td> Totale previsto: </td>  
            <td class="tableprice"> <b>€ {{ basket.pm.getTotal(basket.open_ordered_products) }}</b> </td>    
        </tr>    
    </table>

<!--
        </form>
-->
 
  <div class="ord-ord-title">Paniere da consegnare</div>
        <div class="searchbar">
          <span class="font-searchbar"><span class="glyphicon glyphicon-search"></span></span>
          <input type="text" class="searchbar-text" id="search-bar-closed" placeholder="Cerca tra i prodotti" ng-model="searchQueryClosed"/>       
      </div> 
    <table class="table gas">   
          <thead>  
            <tr>  
              <th scope="col" ng-click="orderByField='order_id'; reverseSort = !reverseSort">Ordine
                  <span ng-show="orderByField == 'order_id'" class="listorder">
                    <span ng-show="!reverseSort"><i class="fa fa-sort-desc"></i></span>
                    <span ng-show="reverseSort"><i class="fa fa-sort-asc"></i></span>
                </span>
                
                </th>  
              <th scope="col" ng-click="orderByField='supplier'; reverseSort = !reverseSort">Fornitore
                  <span ng-show="orderByField == 'supplier'" class="listorder">
                    <span ng-show="!reverseSort"><i class="fa fa-sort-desc"></i></span>
                    <span ng-show="reverseSort"><i class="fa fa-sort-asc"></i></span>
                </span>
                </th>  
              <th scope="col" ng-click="orderByField='name'; reverseSort = !reverseSort">Prodotto
                  <span ng-show="orderByField == 'name'" class="listorder">
                    <span ng-show="!reverseSort"><i class="fa fa-sort-desc"></i></span>
                    <span ng-show="reverseSort"><i class="fa fa-sort-asc"></i></span>
                </span>
                </th>  
              <th scope="col">Prezzo</th>
              <th scope="col">Quantit&agrave;</th>  
              <th scope="col">Totale</th>     
            </tr>  
          </thead>  
          <tbody>  
          <tr ng-repeat="item in basket.closed_ordered_products | filter: searchQueryClosed | orderBy:orderByField:reverseSort">  
              <td data-title="image" class="tdprod">{{item.order_shortname}}</td>  
              <td data-title="image" class="tdprod">{{item.supplier}}</td>  
              <td data-title="image" class="tdprod">{{item.name}}</td>  
              <td data-title="image" class="tdprod">{{item.price|currency:"€"}}</td>  
              <td data-title="image" class="tdprod">{{item.quantity}}</td> 
              <td data-title="image" class="tdprod">{{item.quantity * item.price|currency:"€"}}</td> 
            </tr>  
          </tbody>
    </table>
    <table class="table total">
        <tr>
            <td> Totale previsto: </td>  
            <td class="tableprice"> <b>€ {{ basket.pm.getTotal(basket.closed_ordered_products) }}</b> </td>    
        </tr>    
    </table>
</div>


